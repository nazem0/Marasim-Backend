This Code Was Significantly Refactored,
Check The Before-Refactoring Branch To View The Previous Version.
